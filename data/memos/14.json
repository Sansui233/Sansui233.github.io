[{"id":"2023-11-08 21:54:39","content":"\n简单糊了一下图片浏览器移动端的交互，不是很有细节，但能用。实现方式也不是我满意的，要滑动不闪屏一定得要三个容器，现在只有一个。但 bug 终于修没了……\n\n但是桌面端……emmm 加了 touchevent 就没了桌面端的交互啊……汗，真要做好的话，事件还要先看设备再绑定，touch 和 mouse 的实现逻辑不一样。\n\n但但但又但是，你也不能说支持 touch 的设备就不绑定 click 事件了。因为有一种设备叫触屏笔记本。\n\n有人会说绑 pointer 不就好了。耐思，我本来也是这么想的，因为我最开始绑的就是pointer。直到我发现 pointerUp 在 safari 上基本是不能用的状态，cancel 和 leave 也一样，pointer 事件的触发过程远远没有 touch 事件稳定……\n\n","tags":[],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,0]},{"id":"2023-11-08 01:30:55","content":"\n#react 想要自定义 hook，但里面有依赖怎么办？react 不能检测 custom hook 的 dep 嵌套问题。\n\n看了 stackoverflow，发现确实可以解决，但写起来和有那个大病似的。\n\n```ts\n// my hook\nfunction useHotKey(command, listener, options){\n  /*do something, but how about listener contains extra deps?*/ \n}\n\nfunction useWrapper(reactHookAsDep: any){\n  useEffect(()=>{},[reactHookAsDep])\n}\n\n// in your component\nuseWrapper(\n  useMemo(() => {\n    useHotKey(command, listener, options) // execute your real custom hook\n  },[command, listener, option, extradep]) // full check for all deps\n)\n```\n\n如果不想定义wrapper，那就在组件里直接 useEffect 再 usememo ……没想到吧，dep 参数还能这么用！但依然有 warning，说 dependency 太复杂了\n\n```ts\n// in your component\nuseEffect(()={},[\n  useMemo(()=>{\n    const listener = () => { /*do something with extra deps*/ }\n    useHotKey(command, listener, options) // execute your real custom hook\n  },[command, option, extradep])\n])\n```\n\n我的评价还是有病，新人看不懂的写法类型。宁愿关 warning，发现有状态不刷新的 bug 再调都行……主要还是得靠理解和代码习惯，不然你 lint 倒是直接禁止在顶层调用参数有 function 的 usehook 啊……新人写那还不是直接用，谁会上来就知道套娃写……\n\n","tags":["react"],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,1]},{"id":"2023-11-06 21:20:06","content":"\n这是一条有关于 #博客 图片组件的交互测试。 #漫画 \n\n测试内容是多图条漫，两条的宽度还不一样哈哈。主要就是测一个极端的比例。已经不能开 typora 了，滑不到头简直要命。我的图上传前都有压缩过，先转 webp，然后压缩 80%。如果是尺寸大一点的图可以压 90%.\n\n……safari，你可真是666，长按后图片二进制就无了……那么大一张图在那，标准的html元素，按了就无了，这要我怎么debug……还有底部占空间……我还是先以桌面端为主吧，移动端只是个顺便。\n\n还有一些问题是如果工具要做的话，交互也要一块做。放大缩小拖动边界判定。移动端禁滚动。\n\n\n","tags":["博客","漫画"],"imgsmd":["![1](https://cdn.jsdelivr.net/gh/NamiLing/upic/picgo/202311062132690.webp)","![2](https://cdn.jsdelivr.net/gh/NamiLing/upic/picgo/202311062133783.webp)"],"sourceFile":"002.md","csrIndex":[14,2]},{"id":"2023-11-06 19:18:22","content":"\n突然好喜欢可爱的字体哇~\n\n好想用 consolas 做 UI font，这个有点可爱气质的打字机字体竟然意外适合，找不到任何一个替代品。可惜 mono font 因为等宽空格的关系，中英混排不行。我又是一个非常喜欢在中英文之间打空格的人。最后还是折中用了万能的 IBM Plex Sans。IBM Plex Sans 正文无敌强，和中文搭配也非常好。但是写 UI 的话就显得有点挤了。\n\nUI 字体要和 正文搭起来挺难的。英文字体的搭配主要看几个基线，还有宽度和间距。基本比例一样的都行。但在不同字体间，要找比例一致字体的是一件极其困难的事，因为很容易没特色。IBM Plex Sans 和 arial 的比例就非常接近，只有宽度和风格区别。\n\n","tags":[],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,3]},{"id":"2023-11-05 21:04:56","content":"\n以一个极其复杂的方式解决了 #mdx 渲染后的标签点击事件绑定问题。因为这不是 html 原生标签的替换，就有一点点麻烦。最后是从自定义 remark 的 AST 入手，直接解析后转换标签为对应的 estree 节点，再加上三次传 clickhandler，闭包持有 clickhandler，进行元素替换，终于绑上了……不愿再来一次，有这种需求应该直接写一个替换的框架。\n\n所以我终于可以进行下一步了吗，写 img 相关的组件。但是其实 memo 后端 parse 还有bug，突然到某一条就停了。重构了之后 bug 真的多……search组件还没统一拆出来呢，可以说是因为不会……但主要还是设计问题，没有想好移动端和桌面端怎么做才能统一，不要渲染两遍……还有目录，目录又应该放哪。目录和导航，选一个没吧……\n\n","tags":["mdx"],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,4]},{"id":"2023-11-05 02:51:44","content":"\nscroll bar 好烦！！！还没有一个好的思路来处理 scroll bar 时隐时现导致样式shift的问题。\n\n","tags":[],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,5]},{"id":"2023-11-04 21:43:14","content":"\n看了一下 nextra 的解决方案…………额额额，他们重写了compiler，并没有用 mdx.js 原生的方法去 compile 成不可序列化的函数。他们的结果是可序列化的……不想重复造轮子。\n\n然后我又去搜了下 [discussion](https://github.com/orgs/mdx-js/discussions/1980) ，又看了看 mdx.js 的 doc。才发现人家其实有函数的序列化和反序列化啊！但是不要看 Guide 里面说什么 Next 有自己的 mdx 方法，那个真的很鸡肋，非常鸡肋！最后搞定了，把巨大的 [next-mdx-remote](https://github1s.com/hashicorp/next-mdx-remote/blob/HEAD/src/rsc.tsx) 移除了。这个库倒不是思路有问题，而是很久没有维护了导致不兼容新的插件。可能是 mdx.js 支持了所以停更了吧，没有考证，而且其实它做的事也不是很复杂，但引入的包是真的多，明明有 MDXProvider 但没有导出，又要多引入二十几个包……\n\n","tags":[],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,6]},{"id":"2023-11-03 22:50:03","content":"\n今天是 Clash 全系删库的一天。\n\n","tags":[],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,7]},{"id":"2023-11-02 22:20:54","content":"\n#工具 IPA签名工具：[轻松签](https://esign.yyyue.xyz/)。\n\n今日重要新闻：Clash for windows 删库。原因不知道。有说是晒车牌的，有说是推发了太多个人信息的，有说是内置机场被抓的。\n\n对不起我写着写着代码又开始画画了……这次是一个能画完的独立故事！不是片段了！加油！不加戏的话，九图可以画完！但我是真的会一边画一边加戏……\n\n啊好肝，肝起来根本没有时间写论文。\n\n\n","tags":["工具"],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,8]},{"id":"2023-11-02 03:39:17","content":"\n说来面包推荐了一下 [nextra](https://github.com/shuding/nextra)，我哭了，这不就是，我要的 60% 的功能都有，在这重复造啥轮子呢……\n\n然后想看看他们 rehype 这一圈的文件是怎么组织的，学一学，要被这生态圈里类型不一致问题和版本兼容性问题搞疯了（真的先学后端语言的人会有强类型强迫症）。\n\n然后我就看到了：`// @ts-nocheck` \n\n（手动拜拜微笑脸）\n\n","tags":[],"imgsmd":[],"sourceFile":"002.md","csrIndex":[14,9]}]