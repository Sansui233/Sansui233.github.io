[{"_1":2},"routes/posts.$slug",{"_3":4},"data",{"_5":6,"_78":79,"_82":83},"post",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_17":18,"_23":24,"_25":26,"_27":28,"_29":30,"_69":70,"_72":73,"_74":75,"_76":77},"title","Windows11 右键菜单自定义 - NileSoft Shell","slug","2025-04-19-windows-context-menu","date","2025-04-18T17:21:04.000Z","description","颜狗就是得样式和功能性全要，怎么了","draft",false,"metadata",{"_19":20,"_21":22},"readingTime",2,"wordCount",658.72,"excerpt","（发现简中圈居然没有人写这个事，写个草稿发别的地方）\nWindows11 右键菜单问题被诟病已有，网上很多还原为 win10 菜单的教程……但 win10 有 win10 的问题，有用的没用的都往里放，常用的不常用的混在一起。有没有一种方法可以兼顾好看，同时有合理的菜单层级呢？\n有的 —— Nilesoft Shell。可以自定义的 Win11 右键菜单。已经用了两年多了很好用（以至于差点忘了有这个软件）。\n下载并安装\n下载在官网： https://nilesoft.org/\n安装完后，新菜单应该已经生效了，并且会","content_html","<p>（发现简中圈居然没有人写这个事，写个草稿发别的地方）</p>\n<p>Windows11 右键菜单问题被诟病已有，网上很多还原为 win10 菜单的教程……但 win10 有 win10 的问题，有用的没用的都往里放，常用的不常用的混在一起。有没有一种方法可以兼顾好看，同时有合理的菜单层级呢？</p>\n<p>有的 —— Nilesoft Shell。可以自定义的 Win11 右键菜单。已经用了两年多了很好用（以至于差点忘了有这个软件）。</p>\n<h2>下载并安装</h2>\n<p>下载在官网： <a href=\"https://nilesoft.org/\">https://nilesoft.org/</a></p>\n<p>安装完后，新菜单应该已经生效了，并且会开机自启。这时候可以点点看，如果感觉效果满意就不用再看下去了。</p>\n<p>当然颜狗是不满意的，大部分一级菜单我用不上，我只想保留我常用的，不用的塞到更多选项。如图</p>\n<p><img src=\"https://img-cf.sansui233.com/imgs/2025/04/202504190843358.webp\" alt=\"\"></p>\n<h2>挪动菜单层级</h2>\n<p>如果你是默认安装，<code>C:\\Program Files\\Nilesoft Shell</code> 应该能看见以下的文件结构</p>\n<pre><code>Nilesoft Shell/\n├── shell.exe\n├── shell.nss\n├── imports/\n│   ├── modify.nss\n│   └── ...\n└── ...\n</code></pre>\n<p>以 <code>.nss</code> 结尾的是配置文件，可以用记事本打开。以下是几个案例：</p>\n<h3>1. 收纳不常用菜单至 “更多选项”</h3>\n<p>例如，收纳所有名称里带有 “QQ” 和 “百度” 的菜单项，在 <code>modify.nss</code> 添加如下：</p>\n<pre><code>modify(mode=mode.multiple find=\"QQ|百度|网盘\" menu=title.more_options)\n</code></pre>\n<p>find 中包含的字符串会被匹配，“|”是或。表示匹配“QQ”或“百度”或“网盘”的任意项都会被挪走。</p>\n<p>这是主要的挪菜单的方式，我实际上挪了一大堆。</p>\n<pre><code>modify(mode=mode.multiple\n\tfind=\"收藏夹|打印|共享|PowerRename|Microsoft Defender|Change Attributes|File Locksmith|upic|火绒|百度|QQ|Acrobat|Adobe|OneDrive|在沙盒中运行|PicList|旧版 Windows Media Player\"\n\tmenu=title.more_options)\n</code></pre>\n<h3>2. “创建快捷方式”挪到顶层</h3>\n<p>有人可能看不惯 创建快捷方式 放在了 更多选项 里。要恢复把 <code>modify.nss</code> 中一行注释掉就好。</p>\n<pre><code>modify(mode=mode.multiple\n\twhere=this.id(\n\t\tid.send_to,\n\t\tid.share,\n\t\t// id.create_shortcut, 这行注释掉\n\t\tid.set_as_desktop_background,\n\t\tid.rotate_left,\n\t\t...\n</code></pre>\n<h3>3. 顶层添加新菜单项 “使用 vscode 打开”</h3>\n<p>在 <code>shell.nss</code> 中，新起一行添加</p>\n<pre><code>item(title='Open with VS Code' image=[\\uE272, #22A7F2] cmd='code' args='\"@sel.path\" &#x26;&#x26; exit' sep='top')\n</code></pre>\n<p>添加的这行可以不在最后，添加的位置决定它在菜单中的位置。我添加在了中间，最后的几个 \"import\" 之间。</p>\n<p>要是问为什么我不用 vscode 自带的右键菜单……我的 vscode 装得太早了，那时还没有右键菜单关联，现在也懒得再装了就将就用吧……</p>\n<h3>4. 顶层菜单添加新目录</h3>\n<p>你要是在图片上右键，会发现系统自带有“使用 Windows 画图编辑”“使用照片编辑”“向左旋转”“向右旋转”……我的天，哪个天才设计的，你不知道自家照片 App 打开后能编辑也能旋转吗？（我知道这肯定是两波人开发的但还是想吐槽）</p>\n<p>秉持着只挪不删的原则，在“更多选项”前加了个“编辑”目录。以下加在了 <code>shell.nss</code></p>\n<pre><code>menu(mode=\"multiple\" title=\"编辑\" image=image.glyph(\"\\uE0A1\"))\n{\n}\n</code></pre>\n<p>然后在 <code>modify.nss</code> 里加了</p>\n<pre><code>modify(mode=mode.multiple\n\tfind=\"*编辑|旋转|PDF\"\n\tmenu=\"编辑\")\n</code></pre>\n<p>这样等于说，编辑和旋转相关都被归到了新的“编辑”目录下。加上 PDF 相关操作挪进去。我没有装 WPS，装了 WPS 也可以把 WPS 挪一个目录。</p>\n<h2>生效</h2>\n<p>管理员权限运行安装目录下的 <code>shell.exe</code>，点 Register 生效</p>\n<h2>其他</h2>\n<p>按 shift 后右键菜单，会有一个“Developer” 目录。没错 shift 显示隐藏菜单也可以实现，配置的属性有 <code>vis=key.shift()</code> ，但不是实时变化的所以没有mac 上的好用。除此之外还有喜闻乐见的能配置主题、颜色、图标等……我不管了。</p>\n<h2>参考</h2>\n<p>官网的文档很详细，但是非常面向程序员。不过大部分的需求被人在论坛上问过了，也有人在 issue 里问。不会就去论坛翻一下。看不懂英文开翻译，看不懂文档丢给 AI。</p>\n<p>文档： <a href=\"https://nilesoft.org/docs\">https://nilesoft.org/docs</a></p>\n<p>论坛： <a href=\"https://github.com/moudey/Shell/discussions\">https://github.com/moudey/Shell/discussions</a></p>","content_jsx","const{Fragment:e,jsx:n,jsxs:i}=arguments[0];function _createMdxContent(d){const c={a:\"a\",code:\"code\",h2:\"h2\",h3:\"h3\",img:\"img\",p:\"p\",pre:\"pre\",...d.components};return i(e,{children:[n(c.p,{children:\"（发现简中圈居然没有人写这个事，写个草稿发别的地方）\"}),\"\\n\",n(c.p,{children:\"Windows11 右键菜单问题被诟病已有，网上很多还原为 win10 菜单的教程……但 win10 有 win10 的问题，有用的没用的都往里放，常用的不常用的混在一起。有没有一种方法可以兼顾好看，同时有合理的菜单层级呢？\"}),\"\\n\",n(c.p,{children:\"有的 —— Nilesoft Shell。可以自定义的 Win11 右键菜单。已经用了两年多了很好用（以至于差点忘了有这个软件）。\"}),\"\\n\",n(c.h2,{id:\"下载并安装\",children:\"下载并安装\"}),\"\\n\",i(c.p,{children:[\"下载在官网： \",n(c.a,{href:\"https://nilesoft.org/\",children:\"https://nilesoft.org/\"})]}),\"\\n\",n(c.p,{children:\"安装完后，新菜单应该已经生效了，并且会开机自启。这时候可以点点看，如果感觉效果满意就不用再看下去了。\"}),\"\\n\",n(c.p,{children:\"当然颜狗是不满意的，大部分一级菜单我用不上，我只想保留我常用的，不用的塞到更多选项。如图\"}),\"\\n\",n(c.img,{src:\"https://img-cf.sansui233.com/imgs/2025/04/202504190843358.webp\",alt:\"\"}),\"\\n\",n(c.h2,{id:\"挪动菜单层级\",children:\"挪动菜单层级\"}),\"\\n\",i(c.p,{children:[\"如果你是默认安装，\",n(c.code,{children:\"C:\\\\Program Files\\\\Nilesoft Shell\"}),\" 应该能看见以下的文件结构\"]}),\"\\n\",n(c.pre,{children:n(c.code,{children:\"Nilesoft Shell/\\n├── shell.exe\\n├── shell.nss\\n├── imports/\\n│   ├── modify.nss\\n│   └── ...\\n└── ...\\n\"})}),\"\\n\",i(c.p,{children:[\"以 \",n(c.code,{children:\".nss\"}),\" 结尾的是配置文件，可以用记事本打开。以下是几个案例：\"]}),\"\\n\",n(c.h3,{id:\"1-收纳不常用菜单至-更多选项\",children:\"1. 收纳不常用菜单至 “更多选项”\"}),\"\\n\",i(c.p,{children:[\"例如，收纳所有名称里带有 “QQ” 和 “百度” 的菜单项，在 \",n(c.code,{children:\"modify.nss\"}),\" 添加如下：\"]}),\"\\n\",n(c.pre,{children:n(c.code,{children:'modify(mode=mode.multiple find=\"QQ|百度|网盘\" menu=title.more_options)\\n'})}),\"\\n\",n(c.p,{children:\"find 中包含的字符串会被匹配，“|”是或。表示匹配“QQ”或“百度”或“网盘”的任意项都会被挪走。\"}),\"\\n\",n(c.p,{children:\"这是主要的挪菜单的方式，我实际上挪了一大堆。\"}),\"\\n\",n(c.pre,{children:n(c.code,{children:'modify(mode=mode.multiple\\n\\tfind=\"收藏夹|打印|共享|PowerRename|Microsoft Defender|Change Attributes|File Locksmith|upic|火绒|百度|QQ|Acrobat|Adobe|OneDrive|在沙盒中运行|PicList|旧版 Windows Media Player\"\\n\\tmenu=title.more_options)\\n'})}),\"\\n\",n(c.h3,{id:\"2-创建快捷方式挪到顶层\",children:\"2. “创建快捷方式”挪到顶层\"}),\"\\n\",i(c.p,{children:[\"有人可能看不惯 创建快捷方式 放在了 更多选项 里。要恢复把 \",n(c.code,{children:\"modify.nss\"}),\" 中一行注释掉就好。\"]}),\"\\n\",n(c.pre,{children:n(c.code,{children:\"modify(mode=mode.multiple\\n\\twhere=this.id(\\n\\t\\tid.send_to,\\n\\t\\tid.share,\\n\\t\\t// id.create_shortcut, 这行注释掉\\n\\t\\tid.set_as_desktop_background,\\n\\t\\tid.rotate_left,\\n\\t\\t...\\n\"})}),\"\\n\",n(c.h3,{id:\"3-顶层添加新菜单项-使用-vscode-打开\",children:\"3. 顶层添加新菜单项 “使用 vscode 打开”\"}),\"\\n\",i(c.p,{children:[\"在 \",n(c.code,{children:\"shell.nss\"}),\" 中，新起一行添加\"]}),\"\\n\",n(c.pre,{children:n(c.code,{children:\"item(title='Open with VS Code' image=[\\\\uE272, #22A7F2] cmd='code' args='\\\"@sel.path\\\" && exit' sep='top')\\n\"})}),\"\\n\",n(c.p,{children:'添加的这行可以不在最后，添加的位置决定它在菜单中的位置。我添加在了中间，最后的几个 \"import\" 之间。'}),\"\\n\",n(c.p,{children:\"要是问为什么我不用 vscode 自带的右键菜单……我的 vscode 装得太早了，那时还没有右键菜单关联，现在也懒得再装了就将就用吧……\"}),\"\\n\",n(c.h3,{id:\"4-顶层菜单添加新目录\",children:\"4. 顶层菜单添加新目录\"}),\"\\n\",n(c.p,{children:\"你要是在图片上右键，会发现系统自带有“使用 Windows 画图编辑”“使用照片编辑”“向左旋转”“向右旋转”……我的天，哪个天才设计的，你不知道自家照片 App 打开后能编辑也能旋转吗？（我知道这肯定是两波人开发的但还是想吐槽）\"}),\"\\n\",i(c.p,{children:[\"秉持着只挪不删的原则，在“更多选项”前加了个“编辑”目录。以下加在了 \",n(c.code,{children:\"shell.nss\"})]}),\"\\n\",n(c.pre,{children:n(c.code,{children:'menu(mode=\"multiple\" title=\"编辑\" image=image.glyph(\"\\\\uE0A1\"))\\n{\\n}\\n'})}),\"\\n\",i(c.p,{children:[\"然后在 \",n(c.code,{children:\"modify.nss\"}),\" 里加了\"]}),\"\\n\",n(c.pre,{children:n(c.code,{children:'modify(mode=mode.multiple\\n\\tfind=\"*编辑|旋转|PDF\"\\n\\tmenu=\"编辑\")\\n'})}),\"\\n\",n(c.p,{children:\"这样等于说，编辑和旋转相关都被归到了新的“编辑”目录下。加上 PDF 相关操作挪进去。我没有装 WPS，装了 WPS 也可以把 WPS 挪一个目录。\"}),\"\\n\",n(c.h2,{id:\"生效\",children:\"生效\"}),\"\\n\",i(c.p,{children:[\"管理员权限运行安装目录下的 \",n(c.code,{children:\"shell.exe\"}),\"，点 Register 生效\"]}),\"\\n\",n(c.h2,{id:\"其他\",children:\"其他\"}),\"\\n\",i(c.p,{children:[\"按 shift 后右键菜单，会有一个“Developer” 目录。没错 shift 显示隐藏菜单也可以实现，配置的属性有 \",n(c.code,{children:\"vis=key.shift()\"}),\" ，但不是实时变化的所以没有mac 上的好用。除此之外还有喜闻乐见的能配置主题、颜色、图标等……我不管了。\"]}),\"\\n\",n(c.h2,{id:\"参考\",children:\"参考\"}),\"\\n\",n(c.p,{children:\"官网的文档很详细，但是非常面向程序员。不过大部分的需求被人在论坛上问过了，也有人在 issue 里问。不会就去论坛翻一下。看不懂英文开翻译，看不懂文档丢给 AI。\"}),\"\\n\",i(c.p,{children:[\"文档： \",n(c.a,{href:\"https://nilesoft.org/docs\",children:\"https://nilesoft.org/docs\"})]}),\"\\n\",i(c.p,{children:[\"论坛： \",n(c.a,{href:\"https://github.com/moudey/Shell/discussions\",children:\"https://github.com/moudey/Shell/discussions\"})]})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?n(i,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};","toc",[31,37,57,61,65],{"_7":32,"_33":34,"_35":36},"下载并安装","url","#下载并安装","items",[],{"_7":38,"_33":39,"_35":40},"挪动菜单层级","#挪动菜单层级",[41,45,49,53],{"_7":42,"_33":43,"_35":44},"1. 收纳不常用菜单至 “更多选项”","#1-收纳不常用菜单至-更多选项",[],{"_7":46,"_33":47,"_35":48},"2. “创建快捷方式”挪到顶层","#2-创建快捷方式挪到顶层",[],{"_7":50,"_33":51,"_35":52},"3. 顶层添加新菜单项 “使用 vscode 打开”","#3-顶层添加新菜单项-使用-vscode-打开",[],{"_7":54,"_33":55,"_35":56},"4. 顶层菜单添加新目录","#4-顶层菜单添加新目录",[],{"_7":58,"_33":59,"_35":60},"生效","#生效",[],{"_7":62,"_33":63,"_35":64},"其他","#其他",[],{"_7":66,"_33":67,"_35":68},"参考","#参考",[],"tags",[71],"Windows","categories","工具","keywords",[],"permalink","/posts/2025-04-19-windows-context-menu","prevPost",{"_7":80,"_9":81},"Steam 假入库是怎么做的","2025-04-22-techs-about-steam-crack","nextPost",{"_7":84,"_9":85},"2024 年的总结与分享","2025-01-05-2024-summary"]
