[{"_1":2},"routes/posts.$slug",{"_3":4},"data",{"_5":6,"_55":56,"_58":59},"post",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_17":18,"_23":24,"_25":26,"_27":28,"_29":30,"_45":46,"_48":49,"_50":51,"_53":54},"title","纯函数与算法","slug","pure-function","date","2021-09-24T16:00:00.000Z","description","自从接触了纯函数，刷算法题刷得举步维艰。","draft",false,"metadata",{"_19":20,"_21":22},"readingTime",2,"wordCount",418,"excerpt","自从接触了纯函数，刷算法题刷得举步维艰。\n\n什么是纯函数：同样的传入参数，一定可以得到相同的输出\n\n纯函数又被称为无副作用的函数，不会改变外部的状态。\n比如在 JS 中，array.slice()对数组的切片，返回的是一个新的数组，为纯函数。\n相对的，array.splice()对数组的插入与删除是对于原数组操作，不是纯函数。\n纯函数的意义，在于保证不会对函数外部的状态有隐式的修改。这在大型的、遍地都是状态的系统中非常重要。如果不保证纯函数，多个函数内部去修改了同一外部状态，容易出现意想不到的 Bug。\n图的邻接矩","content_html","<p>自从接触了纯函数，刷算法题刷得举步维艰。</p>\n<blockquote>\n<p>什么是纯函数：同样的传入参数，一定可以得到相同的输出</p>\n</blockquote>\n<p>纯函数又被称为无副作用的函数，不会改变外部的状态。</p>\n<p>比如在 JS 中，array.slice()对数组的切片，返回的是一个新的数组，为纯函数。</p>\n<p>相对的，array.splice()对数组的插入与删除是对于原数组操作，不是纯函数。</p>\n<p>纯函数的意义，在于保证<strong>不会对函数外部的状态有隐式的修改</strong>。这在大型的、遍地都是状态的系统中非常重要。如果不保证纯函数，多个函数内部去修改了同一外部状态，容易出现意想不到的 Bug。</p>\n<h2>图的邻接矩阵定义</h2>\n<p><img src=\"https://raw.githubusercontent.com/NamiLing/upic/master/uPic/g61Yvh.jpg\" alt=\"img\"></p>\n<pre><code class=\"language-ts\">let map = {\r\n  point: ['V0', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7'],\r\n  side: [\r\n    [0, 1, 0, 1, 1, 0, 0, 0],\r\n    [1, 0, 1, 0, 1, 0, 0, 0],\r\n    [0, 1, 0, 0, 0, 1, 0, 0],\r\n    [1, 0, 0, 0, 0, 0, 1, 0],\r\n    [1, 1, 0, 0, 0, 0, 1, 0],\r\n    [0, 0, 1, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 1, 1, 0, 0, 1],\r\n    [0, 0, 0, 0, 0, 0, 1, 0],\r\n  ]\r\n}\n</code></pre>\n<h2>图深度遍历的非纯函数实现</h2>\n<pre><code class=\"language-ts\">// DFS 深度优先遍历，从 第 index 个节点开始. visited 记录已访问的节点，全局共用一个 visited\r\nfunction DFStraverse(index: number = 0, visited = [map.point[0]]) {\r\n  if (visited.length === map.point.length) {\r\n    console.log(visited.toString())\r\n    return\r\n  }\r\n\r\n  map.side[index].forEach((isSide, targetv) => {\r\n    if (isSide &#x26;&#x26; !visited.includes(map.point[targetv])) {\r\n      visited.push(map.point[targetv])\r\n      DFStraverse(targetv, visited)\r\n    }\r\n  })\r\n}\n</code></pre>\n<p>以上代码的问题：</p>\n<ul>\n<li>map 定义在了外部，和别的函数共用</li>\n<li>visited 是全局共用同一个，但却每次都要作为参数传入，逻辑上既不合也没有必要。并且作为函数参数（而不是全局变量），每次都对 visited 作了修改。这里还好，因为要的就是修改后的 visited（实际上是全局的 visited）。但如果题目是一个回溯问题，就需要管理 visited 的状态，在修改了之后，递归出栈时还得改回来。</li>\n</ul>\n<h2>图深度遍历的纯函数实现</h2>\n<pre><code class=\"language-ts\">// DFS 深度优先遍历，从 第 index 个节点开始. visited 记录已访问的节点，全局共用一个 visited\r\n// 纯函数实现\r\nfunction DFStraverse(index: number, map: { point: string[], side: number[][] }) {\r\n  const visited = [map.point[index]]\r\n\r\n  function traverse(index: number) {\r\n    // 终止条件\r\n    if (visited.length === map.point.length) {\r\n      console.log(visited.toString())\r\n      return\r\n    }\r\n\r\n    map.side[index].forEach((isSide, targetv) => {\r\n      if (isSide &#x26;&#x26; !visited.includes(map.point[targetv])) {\r\n        visited.push(map.point[targetv])\r\n        traverse(targetv)\r\n      }\r\n    })\r\n  }\r\n\r\n  traverse(index)\r\n}\n</code></pre>\n<p>使用闭包，把共用的 visited 固定为状态。内部再定义函数作递归。 map 也作为外层的参数传入，里面不去修改。</p>\n<hr>\n<p>状态其实在各种算法里挺重要的。不少空间换时间的极限操作都要用到。</p>\n<p>算法注定是“不纯”的，能做的也不过是用闭包来保存状态。有时候觉得，纯不纯的也没有这么重要。</p>","content_jsx","const{Fragment:s,jsx:n,jsxs:e}=arguments[0];function _createMdxContent(l){const a={blockquote:\"blockquote\",code:\"code\",h2:\"h2\",hr:\"hr\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...l.components};return e(s,{children:[n(a.p,{children:\"自从接触了纯函数，刷算法题刷得举步维艰。\"}),\"\\n\",e(a.blockquote,{children:[\"\\n\",n(a.p,{children:\"什么是纯函数：同样的传入参数，一定可以得到相同的输出\"}),\"\\n\"]}),\"\\n\",n(a.p,{children:\"纯函数又被称为无副作用的函数，不会改变外部的状态。\"}),\"\\n\",n(a.p,{children:\"比如在 JS 中，array.slice()对数组的切片，返回的是一个新的数组，为纯函数。\"}),\"\\n\",n(a.p,{children:\"相对的，array.splice()对数组的插入与删除是对于原数组操作，不是纯函数。\"}),\"\\n\",e(a.p,{children:[\"纯函数的意义，在于保证\",n(a.strong,{children:\"不会对函数外部的状态有隐式的修改\"}),\"。这在大型的、遍地都是状态的系统中非常重要。如果不保证纯函数，多个函数内部去修改了同一外部状态，容易出现意想不到的 Bug。\"]}),\"\\n\",n(a.h2,{id:\"图的邻接矩阵定义\",children:\"图的邻接矩阵定义\"}),\"\\n\",n(a.img,{src:\"https://raw.githubusercontent.com/NamiLing/upic/master/uPic/g61Yvh.jpg\",alt:\"img\"}),\"\\n\",n(a.pre,{children:e(a.code,{className:\"hljs language-ts\",children:[n(a.span,{className:\"hljs-keyword\",children:\"let\"}),\" map = {\\r\\n  \",n(a.span,{className:\"hljs-attr\",children:\"point\"}),\": [\",n(a.span,{className:\"hljs-string\",children:\"'V0'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V1'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V2'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V3'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V4'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V5'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V6'\"}),\", \",n(a.span,{className:\"hljs-string\",children:\"'V7'\"}),\"],\\r\\n  \",n(a.span,{className:\"hljs-attr\",children:\"side\"}),\": [\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\"],\\r\\n    [\",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"1\"}),\", \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"],\\r\\n  ]\\r\\n}\\n\"]})}),\"\\n\",n(a.h2,{id:\"图深度遍历的非纯函数实现\",children:\"图深度遍历的非纯函数实现\"}),\"\\n\",n(a.pre,{children:e(a.code,{className:\"hljs language-ts\",children:[n(a.span,{className:\"hljs-comment\",children:\"// DFS 深度优先遍历，从 第 index 个节点开始. visited 记录已访问的节点，全局共用一个 visited\"}),\"\\r\\n\",n(a.span,{className:\"hljs-keyword\",children:\"function\"}),\" \",n(a.span,{className:\"hljs-title function_\",children:\"DFStraverse\"}),\"(\",e(a.span,{className:\"hljs-params\",children:[n(a.span,{className:\"hljs-attr\",children:\"index\"}),\": \",n(a.span,{className:\"hljs-built_in\",children:\"number\"}),\" = \",n(a.span,{className:\"hljs-number\",children:\"0\"}),\", visited = [map.point[\",n(a.span,{className:\"hljs-number\",children:\"0\"}),\"]]\"]}),\") {\\r\\n  \",n(a.span,{className:\"hljs-keyword\",children:\"if\"}),\" (visited.\",n(a.span,{className:\"hljs-property\",children:\"length\"}),\" === map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\".\",n(a.span,{className:\"hljs-property\",children:\"length\"}),\") {\\r\\n    \",n(a.span,{className:\"hljs-variable language_\",children:\"console\"}),\".\",n(a.span,{className:\"hljs-title function_\",children:\"log\"}),\"(visited.\",n(a.span,{className:\"hljs-title function_\",children:\"toString\"}),\"())\\r\\n    \",n(a.span,{className:\"hljs-keyword\",children:\"return\"}),\"\\r\\n  }\\r\\n\\r\\n  map.\",n(a.span,{className:\"hljs-property\",children:\"side\"}),\"[index].\",n(a.span,{className:\"hljs-title function_\",children:\"forEach\"}),\"(\",e(a.span,{className:\"hljs-function\",children:[\"(\",n(a.span,{className:\"hljs-params\",children:\"isSide, targetv\"}),\") =>\"]}),\" {\\r\\n    \",n(a.span,{className:\"hljs-keyword\",children:\"if\"}),\" (isSide && !visited.\",n(a.span,{className:\"hljs-title function_\",children:\"includes\"}),\"(map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\"[targetv])) {\\r\\n      visited.\",n(a.span,{className:\"hljs-title function_\",children:\"push\"}),\"(map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\"[targetv])\\r\\n      \",n(a.span,{className:\"hljs-title class_\",children:\"DFStraverse\"}),\"(targetv, visited)\\r\\n    }\\r\\n  })\\r\\n}\\n\"]})}),\"\\n\",n(a.p,{children:\"以上代码的问题：\"}),\"\\n\",e(a.ul,{children:[\"\\n\",n(a.li,{children:\"map 定义在了外部，和别的函数共用\"}),\"\\n\",n(a.li,{children:\"visited 是全局共用同一个，但却每次都要作为参数传入，逻辑上既不合也没有必要。并且作为函数参数（而不是全局变量），每次都对 visited 作了修改。这里还好，因为要的就是修改后的 visited（实际上是全局的 visited）。但如果题目是一个回溯问题，就需要管理 visited 的状态，在修改了之后，递归出栈时还得改回来。\"}),\"\\n\"]}),\"\\n\",n(a.h2,{id:\"图深度遍历的纯函数实现\",children:\"图深度遍历的纯函数实现\"}),\"\\n\",n(a.pre,{children:e(a.code,{className:\"hljs language-ts\",children:[n(a.span,{className:\"hljs-comment\",children:\"// DFS 深度优先遍历，从 第 index 个节点开始. visited 记录已访问的节点，全局共用一个 visited\"}),\"\\r\\n\",n(a.span,{className:\"hljs-comment\",children:\"// 纯函数实现\"}),\"\\r\\n\",n(a.span,{className:\"hljs-keyword\",children:\"function\"}),\" \",n(a.span,{className:\"hljs-title function_\",children:\"DFStraverse\"}),\"(\",e(a.span,{className:\"hljs-params\",children:[n(a.span,{className:\"hljs-attr\",children:\"index\"}),\": \",n(a.span,{className:\"hljs-built_in\",children:\"number\"}),\", \",n(a.span,{className:\"hljs-attr\",children:\"map\"}),\": { point: \",n(a.span,{className:\"hljs-built_in\",children:\"string\"}),\"[], side: \",n(a.span,{className:\"hljs-built_in\",children:\"number\"}),\"[][] }\"]}),\") {\\r\\n  \",n(a.span,{className:\"hljs-keyword\",children:\"const\"}),\" visited = [map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\"[index]]\\r\\n\\r\\n  \",n(a.span,{className:\"hljs-keyword\",children:\"function\"}),\" \",n(a.span,{className:\"hljs-title function_\",children:\"traverse\"}),\"(\",e(a.span,{className:\"hljs-params\",children:[n(a.span,{className:\"hljs-attr\",children:\"index\"}),\": \",n(a.span,{className:\"hljs-built_in\",children:\"number\"})]}),\") {\\r\\n    \",n(a.span,{className:\"hljs-comment\",children:\"// 终止条件\"}),\"\\r\\n    \",n(a.span,{className:\"hljs-keyword\",children:\"if\"}),\" (visited.\",n(a.span,{className:\"hljs-property\",children:\"length\"}),\" === map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\".\",n(a.span,{className:\"hljs-property\",children:\"length\"}),\") {\\r\\n      \",n(a.span,{className:\"hljs-variable language_\",children:\"console\"}),\".\",n(a.span,{className:\"hljs-title function_\",children:\"log\"}),\"(visited.\",n(a.span,{className:\"hljs-title function_\",children:\"toString\"}),\"())\\r\\n      \",n(a.span,{className:\"hljs-keyword\",children:\"return\"}),\"\\r\\n    }\\r\\n\\r\\n    map.\",n(a.span,{className:\"hljs-property\",children:\"side\"}),\"[index].\",n(a.span,{className:\"hljs-title function_\",children:\"forEach\"}),\"(\",e(a.span,{className:\"hljs-function\",children:[\"(\",n(a.span,{className:\"hljs-params\",children:\"isSide, targetv\"}),\") =>\"]}),\" {\\r\\n      \",n(a.span,{className:\"hljs-keyword\",children:\"if\"}),\" (isSide && !visited.\",n(a.span,{className:\"hljs-title function_\",children:\"includes\"}),\"(map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\"[targetv])) {\\r\\n        visited.\",n(a.span,{className:\"hljs-title function_\",children:\"push\"}),\"(map.\",n(a.span,{className:\"hljs-property\",children:\"point\"}),\"[targetv])\\r\\n        \",n(a.span,{className:\"hljs-title function_\",children:\"traverse\"}),\"(targetv)\\r\\n      }\\r\\n    })\\r\\n  }\\r\\n\\r\\n  \",n(a.span,{className:\"hljs-title function_\",children:\"traverse\"}),\"(index)\\r\\n}\\n\"]})}),\"\\n\",n(a.p,{children:\"使用闭包，把共用的 visited 固定为状态。内部再定义函数作递归。 map 也作为外层的参数传入，里面不去修改。\"}),\"\\n\",n(a.hr,{}),\"\\n\",n(a.p,{children:\"状态其实在各种算法里挺重要的。不少空间换时间的极限操作都要用到。\"}),\"\\n\",n(a.p,{children:\"算法注定是“不纯”的，能做的也不过是用闭包来保存状态。有时候觉得，纯不纯的也没有这么重要。\"})]})}return{default:function(s={}){const{wrapper:e}=s.components||{};return e?n(e,{...s,children:n(_createMdxContent,{...s})}):_createMdxContent(s)}};","toc",[31,37,41],{"_7":32,"_33":34,"_35":36},"图的邻接矩阵定义","url","#图的邻接矩阵定义","items",[],{"_7":38,"_33":39,"_35":40},"图深度遍历的非纯函数实现","#图深度遍历的非纯函数实现",[],{"_7":42,"_33":43,"_35":44},"图深度遍历的纯函数实现","#图深度遍历的纯函数实现",[],"tags",[47],"算法","categories","学习","keywords",[52,47],"纯函数","permalink","/posts/pure-function","prevPost",{"_7":57,"_9":57},"PPT母版的制作与使用方法","nextPost",{"_7":60,"_9":61},"Github hosts 更新脚本(MAC)","github-hosttools"]
