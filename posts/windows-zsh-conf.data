[{"_1":2},"routes/posts.$slug",{"_3":4},"data",{"_5":6,"_97":98,"_101":102},"post",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_21":22,"_23":24,"_25":26,"_27":28,"_83":84,"_86":87,"_88":89,"_95":96},"title","Windows 命令行相关配置之 msys2+zsh+zi","slug","windows-zsh-conf","date","2024-03-15T12:35:37.000Z","draft",false,"metadata",{"_17":18,"_19":20},"readingTime",4,"wordCount",937.8000000000001,"excerpt","长久以来，遇到 bash 脚本会临时切 git-bash 中的 bash。由于用的语言都有自己的包管理器，倒也一直够用。但是最近涉及到一些 c++，由 git-bash 提供的最小化环境东西缺得太多，几乎不能当个日常 shell 用，也没有 pacman 包管理，最后决定还是单独安装 msys2。\ngit-bash 和 msys2 同时安装不会冲突。msys2 是独立的 home 目录，而 git-bash 是与 windows 当前用户通用的。我本来想卸载 git-bash，但由于我现在还是用 powershel","content_html","<p>长久以来，遇到 bash 脚本会临时切 git-bash 中的 bash。由于用的语言都有自己的包管理器，倒也一直够用。但是最近涉及到一些 c++，由 git-bash 提供的最小化环境东西缺得太多，几乎不能当个日常 shell 用，也没有 pacman 包管理，最后决定还是单独安装 msys2。</p>\n<p>git-bash 和 msys2 同时安装不会冲突。msys2 是独立的 home 目录，而 git-bash 是与 windows 当前用户通用的。我本来想卸载 git-bash，但由于我现在还是用 powershell，最终发现 git-bash 不能卸载。一是 posh-git 只支持 git-bash 的 git；其次是，astro-nvim 中的一些插件需要 <code>git.exe</code> 在环境变量下，使用 alias 链接的 git 不行，而手动加环境变量会把 git 以外的程序也加进去，造成 msys2 的工具与 powershell 本身工具的冲突。</p>\n<p>想来想去，决定保留 git-bash 到最小化的状态，当成 powershell 的插件用。unix-like shell 以及相应的包管理还是 msys2。</p>\n<h2>安装 msys2</h2>\n<p>见 <a href=\"https://www.msys2.org/\">https://www.msys2.org/</a> 。安装过程没什么好说的，唯一要注意的在于安装目录的权限必须是当前用户可以完全控制，否则后续各种包的安装都会有一大堆问题。如果因为强迫症安装到 Program Files 下，则需要手动添加当前用户的权限。</p>\n<h3>软链接问题</h3>\n<p>windows 的软链接本来也是个很麻烦的问题。到 msys2 下，还多了一个软链接方式兼容问题。msys2 默认是 <code>ln -s</code> 是复制，要用 windows 风格的软链接，可以改安装目录下的各种 <code>.ini</code> 文件中的配置。</p>\n<pre><code>MSYS=\"winsymlinks:lnk\"\n</code></pre>\n<h2>zsh + zi</h2>\n<h3>zsh 的安装</h3>\n<pre><code class=\"language-bash\">pacman -S zsh\n</code></pre>\n<p>老实说个人觉得和 linux 上的 zsh 相比还是差了一大截，用起来和 bash 感觉差不多。只是 zsh 插件管理的选择比较多</p>\n<h3>zi 的安装</h3>\n<p>关于 zsh 插件管理，之前在 git-bash 上我也安装了 oh-my-zsh，但是环境原因，遇到的 bug 着实太多，基本不用。另外，最大的问题是启动太慢，每次启动长达 10 秒。我分析了一下初始化脚本的执行时长，发现拖慢速度的罪魁祸首是初始化命令补全（就不能异步吗啊！）当然用 mac 时 omz 也有点慢，但显然没有 msys2 里这么离谱。</p>\n<p>下午吐槽这个事情后，Antarx 说他换 zi 了。我试了下，确实很快，从没超过3s，令人偷税。</p>\n<ul>\n<li>zi 的安装：<a href=\"https://wiki.zshell.dev/docs/getting_started/installation\">https://wiki.zshell.dev/docs/getting_started/installation</a></li>\n</ul>\n<p>安装过程最好在 msys2 的 GUI 终端下进行，因为需要登录的默认目录是在 home 的当前用户下。但这里又有另一个问题 —— msys2 不带 git。如果系统有另外安装 git，想复用，可以 cmd 启动 zsh，不指定启动的目录，指定继承环境变量。</p>\n<pre><code class=\"language-cmd\">C:\\\\msys64\\\\msys2_shell.cmd -defterm -no-start -ucrt64 -use-full-path -shell zsh\n</code></pre>\n<h3>zi 的配置与插件</h3>\n<p><a href=\"https://wiki.zshell.dev/docs/getting_started/installation\">安装Wiki</a> 在不断更新，检查最新版的安装方法。</p>\n<p>安装好后，<code>.zshrc</code> 里添加如下，写好重启 zsh 即可。</p>\n<pre><code class=\"language-bash\">$ vi ~/.zshrc\r\n\r\n# zsh\r\nsetopt AUTO_PUSHD\r\n\r\nexport CLICOLOR=1\r\nexport LSCOLORS=ExGxFxdaCxDaDahbadeche\r\nzstyle ':completion:*' list-colors \"${(@s.:.)LS_COLORS}\"\r\nalias ls='ls --color=auto'\r\nalias la='la --color=auto'\r\n\r\n# zi\r\ntypeset -A ZI\r\nZI[BIN_DIR]=\"${HOME}/.zi/bin\"\r\nsource \"${ZI[BIN_DIR]}/zi.zsh\"\r\n\r\nautoload -Uz _zi\r\n(( ${+_comps} )) &#x26;&#x26; _comps[zi]=_zi\r\n# source &#x3C;(curl -sL init.zshell.dev); zzinit\r\n\r\n\r\n# 插件\r\n# 提前运行一次 zi ice pick\"async.zsh\" src\"pure.zsh\"\r\nzi light sindresorhus/pure \r\nzi light agkozak/zsh-z  # 不能用 eval \"$(zoxide init zsh)\" 会冲突\r\nzi snippet OMZP::git\r\nzi light zsh-users/zsh-completions\r\n# 提前运行一次 zi ice wait lucid atload'_zsh_autosuggest_start'\r\nzi light zsh-users/zsh-autosuggestions \r\n# 提前运行一次 zi ice wait lucid atinit='zpcompinit'\r\nzi light zdharma/fast-syntax-highlighting\r\n\r\n\n</code></pre>\n<h2>Windows Terminal 设置</h2>\n<p>在设置里改 json，加相应的 profile。可以使用 <code>-use-full-path</code> 继承 windows 系统的环境变量。</p>\n<pre><code class=\"language-json\">{\r\n    \"commandline\": \"C:\\\\msys64\\\\msys2_shell.cmd -defterm -here -no-start -ucrt64 -use-full-path -shell zsh\",\r\n    \"guid\": \"{c420e0af-28d9-4742-a6b8-83d5fcf424e9}\",\r\n    \"icon\": \"C:\\\\msys64\\\\ucrt64.ico\",\r\n    \"name\": \"msys2 zsh\",\r\n    \"startingDirectory\": \"%USERPROFILE%\"\r\n}\n</code></pre>\n<h2>Vscode Terminal 设置</h2>\n<pre><code class=\"language-json\">\"terminal.integrated.profiles.windows\": {\r\n    \"MSYS2 zsh\": {\r\n        \"path\": \"C:\\\\msys64\\\\msys2_shell.cmd\",\r\n        \"args\": [\"-defterm\",\"-here\",\"-no-start\",\"-ucrt64\",\"-use-full-path\",\"-shell\",\"zsh\"],\r\n        \"env\": { \"MSYSTEM\": \"UCRT64\" },\r\n        \"overrideName\": true\r\n    },\r\n},\n</code></pre>\n<h2>Mintty 设置</h2>\n<p>Mintty 是 msys2 里默认的终端 GUI，默认 shell 是 bash。修改 <code>mingw64.ini</code> 为如下内容。</p>\n<pre><code>MSYS=winsymlinks:lnk\r\nMSYS2_PATH_TYPE=inherit\r\nMSYSTEM=UCRT64\r\nSHELL=/usr/bin/zsh\n</code></pre>\n<h2>npm设置</h2>\n<p>如果有使用 npm 进行包管理，继承自环境变量的 npm 补全时会报错。需要设置为</p>\n<pre><code class=\"language-shell\">$ npm config edit\r\nscript-shell=C:\\msys64\\usr\\bin\\bash.exe\r\nshell=C:\\msys64\\msys2\\usr\\bin\\bash.exe # 重要\r\n$ npm config list\n</code></pre>\n<h2>conda 设置</h2>\n<p>如果有使用 conda 进行 python 开发，继承自环境变量的 conda 默认初始化脚本也有问题……从 Github 上查到的解决方法……</p>\n<pre><code class=\"language-shell\"># >>> conda initialize >>>\r\n# !! Contents within this block are managed by 'conda init' !!\r\nif [ -f '/c/Users/me/miniconda3/Scripts/conda.exe' ]; then\r\n    #eval \"$('/c/Users/me/miniconda3/Scripts/conda.exe' 'shell.zsh' 'hook')\"\r\n    eval \"$('/c/Users/me/miniconda3/Scripts/conda.exe' 'shell.zsh' 'hook' | sed -e 's/\"$CONDA_EXE\" $_CE_M $_CE_CONDA \"$@\"/\"$CONDA_EXE\" $_CE_M $_CE_CONDA \"$@\" | tr -d \\x27\\\\r\\x27/g')\"\r\nfi\r\n# &#x3C;&#x3C;&#x3C; conda initialize &#x3C;&#x3C;&#x3C;\n</code></pre>\n<h3>ssh配置共用</h3>\n<p>如果有多个 ssh 账户的密钥，最好是软链接一下配置目录。注意需要前面的修改软链接方式，否则还是去资源管理器手动软链接吧。</p>\n<pre><code class=\"language-shell\">ln -s /c/Users/me/.ssh ~/.ssh\n</code></pre>\n<h2>参考</h2>\n<p><a href=\"https://hustlei.github.io/2018/11/msys2-for-win.html#%E5%AE%89%E8%A3%85git%E5%92%8Cvim\">msys2-for-win</a></p>\n<p><a href=\"https://sdl.moe/post/zsh-conf/\">https://sdl.moe/post/zsh-conf/</a></p>","content_jsx","const{Fragment:s,jsx:n,jsxs:a}=arguments[0];function _createMdxContent(l){const e={a:\"a\",code:\"code\",h2:\"h2\",h3:\"h3\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...l.components};return a(s,{children:[n(e.p,{children:\"长久以来，遇到 bash 脚本会临时切 git-bash 中的 bash。由于用的语言都有自己的包管理器，倒也一直够用。但是最近涉及到一些 c++，由 git-bash 提供的最小化环境东西缺得太多，几乎不能当个日常 shell 用，也没有 pacman 包管理，最后决定还是单独安装 msys2。\"}),\"\\n\",a(e.p,{children:[\"git-bash 和 msys2 同时安装不会冲突。msys2 是独立的 home 目录，而 git-bash 是与 windows 当前用户通用的。我本来想卸载 git-bash，但由于我现在还是用 powershell，最终发现 git-bash 不能卸载。一是 posh-git 只支持 git-bash 的 git；其次是，astro-nvim 中的一些插件需要 \",n(e.code,{children:\"git.exe\"}),\" 在环境变量下，使用 alias 链接的 git 不行，而手动加环境变量会把 git 以外的程序也加进去，造成 msys2 的工具与 powershell 本身工具的冲突。\"]}),\"\\n\",n(e.p,{children:\"想来想去，决定保留 git-bash 到最小化的状态，当成 powershell 的插件用。unix-like shell 以及相应的包管理还是 msys2。\"}),\"\\n\",n(e.h2,{id:\"安装-msys2\",children:\"安装 msys2\"}),\"\\n\",a(e.p,{children:[\"见 \",n(e.a,{href:\"https://www.msys2.org/\",children:\"https://www.msys2.org/\"}),\" 。安装过程没什么好说的，唯一要注意的在于安装目录的权限必须是当前用户可以完全控制，否则后续各种包的安装都会有一大堆问题。如果因为强迫症安装到 Program Files 下，则需要手动添加当前用户的权限。\"]}),\"\\n\",n(e.h3,{id:\"软链接问题\",children:\"软链接问题\"}),\"\\n\",a(e.p,{children:[\"windows 的软链接本来也是个很麻烦的问题。到 msys2 下，还多了一个软链接方式兼容问题。msys2 默认是 \",n(e.code,{children:\"ln -s\"}),\" 是复制，要用 windows 风格的软链接，可以改安装目录下的各种 \",n(e.code,{children:\".ini\"}),\" 文件中的配置。\"]}),\"\\n\",n(e.pre,{children:n(e.code,{children:'MSYS=\"winsymlinks:lnk\"\\n'})}),\"\\n\",n(e.h2,{id:\"zsh--zi\",children:\"zsh + zi\"}),\"\\n\",n(e.h3,{id:\"zsh-的安装\",children:\"zsh 的安装\"}),\"\\n\",n(e.pre,{children:n(e.code,{className:\"hljs language-bash\",children:\"pacman -S zsh\\n\"})}),\"\\n\",n(e.p,{children:\"老实说个人觉得和 linux 上的 zsh 相比还是差了一大截，用起来和 bash 感觉差不多。只是 zsh 插件管理的选择比较多\"}),\"\\n\",n(e.h3,{id:\"zi-的安装\",children:\"zi 的安装\"}),\"\\n\",n(e.p,{children:\"关于 zsh 插件管理，之前在 git-bash 上我也安装了 oh-my-zsh，但是环境原因，遇到的 bug 着实太多，基本不用。另外，最大的问题是启动太慢，每次启动长达 10 秒。我分析了一下初始化脚本的执行时长，发现拖慢速度的罪魁祸首是初始化命令补全（就不能异步吗啊！）当然用 mac 时 omz 也有点慢，但显然没有 msys2 里这么离谱。\"}),\"\\n\",n(e.p,{children:\"下午吐槽这个事情后，Antarx 说他换 zi 了。我试了下，确实很快，从没超过3s，令人偷税。\"}),\"\\n\",a(e.ul,{children:[\"\\n\",a(e.li,{children:[\"zi 的安装：\",n(e.a,{href:\"https://wiki.zshell.dev/docs/getting_started/installation\",children:\"https://wiki.zshell.dev/docs/getting_started/installation\"})]}),\"\\n\"]}),\"\\n\",n(e.p,{children:\"安装过程最好在 msys2 的 GUI 终端下进行，因为需要登录的默认目录是在 home 的当前用户下。但这里又有另一个问题 —— msys2 不带 git。如果系统有另外安装 git，想复用，可以 cmd 启动 zsh，不指定启动的目录，指定继承环境变量。\"}),\"\\n\",n(e.pre,{children:n(e.code,{className:\"hljs language-cmd\",children:\"C:\\\\\\\\msys64\\\\\\\\msys2_shell.cmd -defterm -no-start -ucrt64 -use-full-path -shell zsh\\n\"})}),\"\\n\",n(e.h3,{id:\"zi-的配置与插件\",children:\"zi 的配置与插件\"}),\"\\n\",a(e.p,{children:[n(e.a,{href:\"https://wiki.zshell.dev/docs/getting_started/installation\",children:\"安装Wiki\"}),\" 在不断更新，检查最新版的安装方法。\"]}),\"\\n\",a(e.p,{children:[\"安装好后，\",n(e.code,{children:\".zshrc\"}),\" 里添加如下，写好重启 zsh 即可。\"]}),\"\\n\",n(e.pre,{children:a(e.code,{className:\"hljs language-bash\",children:[\"$ vi ~/.zshrc\\r\\n\\r\\n\",n(e.span,{className:\"hljs-comment\",children:\"# zsh\"}),\"\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"setopt\"}),\" AUTO_PUSHD\\r\\n\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"export\"}),\" CLICOLOR=1\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"export\"}),\" LSCOLORS=ExGxFxdaCxDaDahbadeche\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"zstyle\"}),\" \",n(e.span,{className:\"hljs-string\",children:\"':completion:*'\"}),\" list-colors \",a(e.span,{className:\"hljs-string\",children:['\"',n(e.span,{className:\"hljs-variable\",children:\"${(@s.:.)LS_COLORS}\"}),'\"']}),\"\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"alias\"}),\" \",n(e.span,{className:\"hljs-built_in\",children:\"ls\"}),\"=\",n(e.span,{className:\"hljs-string\",children:\"'ls --color=auto'\"}),\"\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"alias\"}),\" la=\",n(e.span,{className:\"hljs-string\",children:\"'la --color=auto'\"}),\"\\r\\n\\r\\n\",n(e.span,{className:\"hljs-comment\",children:\"# zi\"}),\"\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"typeset\"}),\" -A ZI\\r\\nZI[BIN_DIR]=\",a(e.span,{className:\"hljs-string\",children:['\"',n(e.span,{className:\"hljs-variable\",children:\"${HOME}\"}),'/.zi/bin\"']}),\"\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"source\"}),\" \",a(e.span,{className:\"hljs-string\",children:['\"',n(e.span,{className:\"hljs-variable\",children:\"${ZI[BIN_DIR]}\"}),'/zi.zsh\"']}),\"\\r\\n\\r\\n\",n(e.span,{className:\"hljs-built_in\",children:\"autoload\"}),\" -Uz _zi\\r\\n(( \",n(e.span,{className:\"hljs-variable\",children:\"${+_comps}\"}),\" )) && _comps[zi]=_zi\\r\\n\",n(e.span,{className:\"hljs-comment\",children:\"# source <(curl -sL init.zshell.dev); zzinit\"}),\"\\r\\n\\r\\n\\r\\n\",n(e.span,{className:\"hljs-comment\",children:\"# 插件\"}),\"\\r\\n\",n(e.span,{className:\"hljs-comment\",children:'# 提前运行一次 zi ice pick\"async.zsh\" src\"pure.zsh\"'}),\"\\r\\nzi light sindresorhus/pure \\r\\nzi light agkozak/zsh-z  \",n(e.span,{className:\"hljs-comment\",children:'# 不能用 eval \"$(zoxide init zsh)\" 会冲突'}),\"\\r\\nzi snippet OMZP::git\\r\\nzi light zsh-users/zsh-completions\\r\\n\",n(e.span,{className:\"hljs-comment\",children:\"# 提前运行一次 zi ice wait lucid atload'_zsh_autosuggest_start'\"}),\"\\r\\nzi light zsh-users/zsh-autosuggestions \\r\\n\",n(e.span,{className:\"hljs-comment\",children:\"# 提前运行一次 zi ice wait lucid atinit='zpcompinit'\"}),\"\\r\\nzi light zdharma/fast-syntax-highlighting\\r\\n\\r\\n\\n\"]})}),\"\\n\",n(e.h2,{id:\"windows-terminal-设置\",children:\"Windows Terminal 设置\"}),\"\\n\",a(e.p,{children:[\"在设置里改 json，加相应的 profile。可以使用 \",n(e.code,{children:\"-use-full-path\"}),\" 继承 windows 系统的环境变量。\"]}),\"\\n\",n(e.pre,{children:a(e.code,{className:\"hljs language-json\",children:[n(e.span,{className:\"hljs-punctuation\",children:\"{\"}),\"\\r\\n    \",n(e.span,{className:\"hljs-attr\",children:'\"commandline\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"C:\\\\\\\\msys64\\\\\\\\msys2_shell.cmd -defterm -here -no-start -ucrt64 -use-full-path -shell zsh\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n    \",n(e.span,{className:\"hljs-attr\",children:'\"guid\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"{c420e0af-28d9-4742-a6b8-83d5fcf424e9}\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n    \",n(e.span,{className:\"hljs-attr\",children:'\"icon\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"C:\\\\\\\\msys64\\\\\\\\ucrt64.ico\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n    \",n(e.span,{className:\"hljs-attr\",children:'\"name\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"msys2 zsh\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n    \",n(e.span,{className:\"hljs-attr\",children:'\"startingDirectory\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"%USERPROFILE%\"'}),\"\\r\\n\",n(e.span,{className:\"hljs-punctuation\",children:\"}\"}),\"\\n\"]})}),\"\\n\",n(e.h2,{id:\"vscode-terminal-设置\",children:\"Vscode Terminal 设置\"}),\"\\n\",n(e.pre,{children:a(e.code,{className:\"hljs language-json\",children:[n(e.span,{className:\"hljs-attr\",children:'\"terminal.integrated.profiles.windows\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-punctuation\",children:\"{\"}),\"\\r\\n    \",n(e.span,{className:\"hljs-attr\",children:'\"MSYS2 zsh\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-punctuation\",children:\"{\"}),\"\\r\\n        \",n(e.span,{className:\"hljs-attr\",children:'\"path\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"C:\\\\\\\\msys64\\\\\\\\msys2_shell.cmd\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n        \",n(e.span,{className:\"hljs-attr\",children:'\"args\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-punctuation\",children:\"[\"}),n(e.span,{className:\"hljs-string\",children:'\"-defterm\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),n(e.span,{className:\"hljs-string\",children:'\"-here\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),n(e.span,{className:\"hljs-string\",children:'\"-no-start\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),n(e.span,{className:\"hljs-string\",children:'\"-ucrt64\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),n(e.span,{className:\"hljs-string\",children:'\"-use-full-path\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),n(e.span,{className:\"hljs-string\",children:'\"-shell\"'}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),n(e.span,{className:\"hljs-string\",children:'\"zsh\"'}),n(e.span,{className:\"hljs-punctuation\",children:\"]\"}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n        \",n(e.span,{className:\"hljs-attr\",children:'\"env\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-punctuation\",children:\"{\"}),\" \",n(e.span,{className:\"hljs-attr\",children:'\"MSYSTEM\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-string\",children:'\"UCRT64\"'}),\" \",n(e.span,{className:\"hljs-punctuation\",children:\"}\"}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n        \",n(e.span,{className:\"hljs-attr\",children:'\"overrideName\"'}),n(e.span,{className:\"hljs-punctuation\",children:\":\"}),\" \",n(e.span,{className:\"hljs-literal\",children:n(e.span,{className:\"hljs-keyword\",children:\"true\"})}),\"\\r\\n    \",n(e.span,{className:\"hljs-punctuation\",children:\"}\"}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\r\\n\",n(e.span,{className:\"hljs-punctuation\",children:\"}\"}),n(e.span,{className:\"hljs-punctuation\",children:\",\"}),\"\\n\"]})}),\"\\n\",n(e.h2,{id:\"mintty-设置\",children:\"Mintty 设置\"}),\"\\n\",a(e.p,{children:[\"Mintty 是 msys2 里默认的终端 GUI，默认 shell 是 bash。修改 \",n(e.code,{children:\"mingw64.ini\"}),\" 为如下内容。\"]}),\"\\n\",n(e.pre,{children:n(e.code,{children:\"MSYS=winsymlinks:lnk\\r\\nMSYS2_PATH_TYPE=inherit\\r\\nMSYSTEM=UCRT64\\r\\nSHELL=/usr/bin/zsh\\n\"})}),\"\\n\",n(e.h2,{id:\"npm设置\",children:\"npm设置\"}),\"\\n\",n(e.p,{children:\"如果有使用 npm 进行包管理，继承自环境变量的 npm 补全时会报错。需要设置为\"}),\"\\n\",n(e.pre,{children:a(e.code,{className:\"hljs language-shell\",children:[n(e.span,{className:\"hljs-meta prompt_\",children:\"$ \"}),n(e.span,{className:\"bash\",children:\"npm config edit\"}),\"\\r\\nscript-shell=C:\\\\msys64\\\\usr\\\\bin\\\\bash.exe\\r\\nshell=C:\\\\msys64\\\\msys2\\\\usr\\\\bin\\\\bash.exe # 重要\\r\",n(e.span,{className:\"hljs-meta prompt_\",children:\"\\n$ \"}),n(e.span,{className:\"bash\",children:\"npm config list\"}),\"\\n\"]})}),\"\\n\",n(e.h2,{id:\"conda-设置\",children:\"conda 设置\"}),\"\\n\",n(e.p,{children:\"如果有使用 conda 进行 python 开发，继承自环境变量的 conda 默认初始化脚本也有问题……从 Github 上查到的解决方法……\"}),\"\\n\",n(e.pre,{children:a(e.code,{className:\"hljs language-shell\",children:[n(e.span,{className:\"hljs-meta prompt_\",children:\"# \"}),n(e.span,{className:\"bash\",children:\">>> conda initialize >>>\"}),\"\\r\",n(e.span,{className:\"hljs-meta prompt_\",children:\"\\n# \"}),a(e.span,{className:\"bash\",children:[\"!! Contents within this block are managed by \",n(e.span,{className:\"hljs-string\",children:\"'conda init'\"}),\" !!\"]}),\"\\r\\nif [ -f '/c/Users/me/miniconda3/Scripts/conda.exe' ]; then\\r\\n    #eval \\\"$('/c/Users/me/miniconda3/Scripts/conda.exe' 'shell.zsh' 'hook')\\\"\\r\\n    eval \\\"$('/c/Users/me/miniconda3/Scripts/conda.exe' 'shell.zsh' 'hook' | sed -e 's/\\\"$CONDA_EXE\\\" $_CE_M $_CE_CONDA \\\"$@\\\"/\\\"$CONDA_EXE\\\" $_CE_M $_CE_CONDA \\\"$@\\\" | tr -d \\\\x27\\\\\\\\r\\\\x27/g')\\\"\\r\\nfi\\r\",n(e.span,{className:\"hljs-meta prompt_\",children:\"\\n# \"}),a(e.span,{className:\"bash\",children:[\"<<< \",n(e.span,{className:\"hljs-string\",children:\"conda initialize <<<\"})]}),\"\\n\"]})}),\"\\n\",n(e.h3,{id:\"ssh配置共用\",children:\"ssh配置共用\"}),\"\\n\",n(e.p,{children:\"如果有多个 ssh 账户的密钥，最好是软链接一下配置目录。注意需要前面的修改软链接方式，否则还是去资源管理器手动软链接吧。\"}),\"\\n\",n(e.pre,{children:n(e.code,{className:\"hljs language-shell\",children:\"ln -s /c/Users/me/.ssh ~/.ssh\\n\"})}),\"\\n\",n(e.h2,{id:\"参考\",children:\"参考\"}),\"\\n\",n(e.p,{children:n(e.a,{href:\"https://hustlei.github.io/2018/11/msys2-for-win.html#%E5%AE%89%E8%A3%85git%E5%92%8Cvim\",children:\"msys2-for-win\"})}),\"\\n\",n(e.p,{children:n(e.a,{href:\"https://sdl.moe/post/zsh-conf/\",children:\"https://sdl.moe/post/zsh-conf/\"})})]})}return{default:function(s={}){const{wrapper:a}=s.components||{};return a?n(a,{...s,children:n(_createMdxContent,{...s})}):_createMdxContent(s)}};","toc",[29,39,55,59,63,67,71,79],{"_7":30,"_31":32,"_33":34},"安装 msys2","url","#安装-msys2","items",[35],{"_7":36,"_31":37,"_33":38},"软链接问题","#软链接问题",[],{"_7":40,"_31":41,"_33":42},"zsh + zi","#zsh--zi",[43,47,51],{"_7":44,"_31":45,"_33":46},"zsh 的安装","#zsh-的安装",[],{"_7":48,"_31":49,"_33":50},"zi 的安装","#zi-的安装",[],{"_7":52,"_31":53,"_33":54},"zi 的配置与插件","#zi-的配置与插件",[],{"_7":56,"_31":57,"_33":58},"Windows Terminal 设置","#windows-terminal-设置",[],{"_7":60,"_31":61,"_33":62},"Vscode Terminal 设置","#vscode-terminal-设置",[],{"_7":64,"_31":65,"_33":66},"Mintty 设置","#mintty-设置",[],{"_7":68,"_31":69,"_33":70},"npm设置","#npm设置",[],{"_7":72,"_31":73,"_33":74},"conda 设置","#conda-设置",[75],{"_7":76,"_31":77,"_33":78},"ssh配置共用","#ssh配置共用",[],{"_7":80,"_31":81,"_33":82},"参考","#参考",[],"tags",[85],"Windows","categories","工具","keywords",[90,91,92,93,94],"Windows命令行","Windows调整，Windows设置","powershell","msys2","zshell","permalink","/posts/windows-zsh-conf","prevPost",{"_7":99,"_9":100},"Windows 调整之中文字体","2023-09-29-windows-system-chinese-fonts-adjustment","nextPost",{"_7":103,"_9":104},"笔记 - 像素的一生","2024-02-29_像素的一生"]
